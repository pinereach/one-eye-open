import{r as o,j as e,b as k}from"./index-D-e82DwX.js";import{f as j}from"./format-Cpou_ref.js";import{f as N}from"./index-BAgxTVAR.js";const v=20,g=["#2563eb","#16a34a","#dc2626","#d97706","#7c3aed","#0d9488","#db2777","#4f46e5","#059669","#ea580c","#0891b2","#c026d3","#e11d48","#0284c7","#65a30d","#9333ea","#0e7490","#c2410c","#0f766e","#be185d","#ca8a04","#1d4ed8","#15803d","#b91c1c"];function w(a){let t=0;for(let s=0;s<a.length;s++)t=(t<<5)-t+a.charCodeAt(s)|0;return Math.abs(t)}function y(a){if(!(!a||a==="—"))return g[w(a)%g.length]}function _({showTitle:a=!0}){const[t,s]=o.useState([]),[h,n]=o.useState(!0);if(o.useEffect(()=>{async function r(){n(!0);try{const{trades:d}=await k.getTape(v);s(d??[])}catch(d){console.error("Failed to load trade tape:",d),s([])}finally{n(!1)}}r()},[]),h)return e.jsxs("div",{className:"rounded-lg border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800/80 shadow-sm p-4",children:[a&&e.jsx("h2",{className:"text-sm font-bold text-gray-600 dark:text-gray-400 mb-3",children:"Trade tape"}),e.jsx("div",{className:"animate-pulse space-y-3",children:[1,2,3,4,5].map(r=>e.jsx("div",{className:"h-12 bg-gray-200 dark:bg-gray-700 rounded-lg"},r))})]});if(t.length===0)return e.jsxs("div",{className:"rounded-lg border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800/80 shadow-sm p-6",children:[a&&e.jsx("h2",{className:"text-sm font-bold text-gray-600 dark:text-gray-400 mb-3",children:"Trade tape"}),e.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center",children:[e.jsx("svg",{className:"w-10 h-10 text-gray-300 dark:text-gray-600 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":!0,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No recent trades"})]})]});const p=!a;return e.jsxs("div",{className:"rounded-lg border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800/80 shadow-sm overflow-hidden",children:[a&&e.jsx("h2",{className:"text-sm font-bold text-gray-600 dark:text-gray-400 px-4 pt-3 pb-2",children:"Trade tape"}),e.jsx("div",{className:`px-3 sm:px-4 ${p?"py-3":"py-2 max-h-[280px] overflow-y-auto"}`,children:e.jsx("div",{className:"space-y-2",children:t.map(r=>{const d=r.buyer_username??"—",c=r.seller_username??"—",l=y(d),i=y(c),x=r.contracts,b=x===1?"share":"shares",u=r.outcome_name||r.outcome_ticker||r.outcome||"—",m=r.market_short_name||r.market_id||"—",f=r.create_time?N(new Date(r.create_time*1e3),"M/d h:mm a"):"—";return e.jsxs("div",{className:"rounded-lg border border-gray-100 dark:border-gray-700 bg-gray-50/80 dark:bg-gray-700/30 overflow-hidden border-l-4 border-l-green-500 dark:border-l-green-500",children:[e.jsxs("div",{className:"px-3 sm:px-4 py-3 text-sm text-gray-800 dark:text-gray-200 leading-snug",children:[e.jsx("span",{className:"font-bold",style:l?{color:l}:void 0,children:d})," bought ",e.jsx("span",{className:"font-bold text-gray-900 dark:text-gray-100",children:x})," ",b," of ",e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:u})," at ",e.jsx("span",{className:"font-bold text-gray-900 dark:text-gray-100",children:j(r.price)})," from ",e.jsx("span",{className:"font-bold",style:i?{color:i}:void 0,children:c}),"."]}),e.jsxs("div",{className:"px-3 sm:px-4 py-2 flex items-center justify-between gap-2 border-t border-gray-100 dark:border-gray-600/50",children:[e.jsx("span",{className:"truncate min-w-0 text-xs text-gray-500 dark:text-gray-400",title:m,children:m}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap flex-shrink-0 px-2 py-0.5 rounded bg-gray-200/80 dark:bg-gray-600/50",children:f})]})]},r.id)})})})]})}function M(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Trade tape"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Recent activity across all markets"})]}),e.jsx(_,{showTitle:!1})]})}export{M as TapePage};

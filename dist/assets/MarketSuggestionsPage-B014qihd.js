import{u as J,r,j as e,N as K,b as P}from"./index-Cw9qrF9s.js";import{u as Q,T as W}from"./Toast-VMIlh5Z5.js";function te(){const{user:T}=J(),[H,y]=r.useState(!1),[R,f]=r.useState(!1),{toasts:G,showToast:n,removeToast:V}=Q(),[o,C]=r.useState(1),[b,F]=r.useState(""),[p,B]=r.useState(""),[l,A]=r.useState([]),[v,U]=r.useState(!1),[N,_]=r.useState([]),[g,M]=r.useState(""),[x,q]=r.useState(""),[S,O]=r.useState([]),[m,E]=r.useState(""),[u,I]=r.useState(""),[k,$]=r.useState([]),[D,j]=r.useState(!1);if(T&&!T.view_market_creation)return e.jsx(K,{to:"/markets",replace:!0});r.useEffect(()=>{async function t(){U(!0);try{const{participants:a}=await P.getParticipants(),s=(a||[]).map(c=>({id:c.id||c.name,name:c.name}));A(s)}catch(a){console.error("Failed to load participants:",a)}finally{U(!1)}}t()},[]),r.useEffect(()=>{if(b&&o&&p.trim()){const t=l.find(a=>a.id===b);if(t){const a=t.name,s=`${a} Over ${p.trim()} - Round ${o}`,i=`${a.split(" ").map(h=>h[0]).join("").toUpperCase()}-OV-R${o}-${p.trim().replace(".","_")}`;_([{name:s,ticker:i,strike:p.trim()}])}}else _([])},[b,o,p,l]),r.useEffect(()=>{if(g&&x.trim()){const t=l.find(a=>a.id===g);if(t){const a=t.name,s=`${a} Over ${x.trim()} - Total Birdies`,i=`${a.split(" ").map(h=>h[0]).join("").toUpperCase()}-OV-${x.trim().replace(".","_")}`;O([{name:s,ticker:i,strike:x.trim()}])}}else O([])},[g,x,l]);const w=t=>t.trim().replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").toUpperCase()||"X";r.useEffect(()=>{if(m&&u&&m!==u){const t=l.find(s=>s.id===m),a=l.find(s=>s.id===u);if(t&&a){const s=t.name,c=a.name,i=w(s),h=w(c);$([{name:`${s} Over ${c}`,ticker:`${i}-OV-${h}`,strike:""}])}}else $([])},[m,u,l]);const z=async t=>{if(t.preventDefault(),y(!0),!b||!o||!p.trim()){n("Please fill in all required fields (Participant, Round, and Strike)","error"),y(!1);return}if(N.length!==1){n("Please ensure outcome is generated correctly","error"),y(!1);return}if(!l.find(i=>i.id===b)){n("Invalid participant selected","error"),y(!1);return}const s=`Round ${o} Over/Under`,c=`R${o}OU`;try{await P.suggestMarket({short_name:s,symbol:c,max_winners:1,min_winners:1,round_number:o,outcomes:N.map(i=>({name:i.name.trim(),ticker:i.ticker.trim(),strike:i.strike.trim()||void 0}))}),n("Market suggestion submitted successfully!","success"),C(1),F(""),B(""),_([])}catch(i){console.error("Failed to submit market suggestion:",i),n(i.message||"Failed to submit market suggestion","error")}finally{y(!1)}},L=async t=>{if(t.preventDefault(),f(!0),!g||!x.trim()){n("Please fill in Participant and Strike","error"),f(!1);return}if(S.length!==1){n("Please ensure outcome is generated correctly","error"),f(!1);return}if(!l.find(s=>s.id===g)){n("Invalid participant selected","error"),f(!1);return}try{await P.suggestMarket({short_name:"Total Birdies",symbol:"BIRDIES",max_winners:1,min_winners:1,outcomes:S.map(s=>({name:s.name.trim(),ticker:s.ticker.trim(),strike:s.strike.trim()||void 0}))}),n("Total Birdies suggestion submitted successfully!","success"),M(""),q(""),O([])}catch(s){console.error("Failed to submit Total Birdies suggestion:",s),n(s.message||"Failed to submit suggestion","error")}finally{f(!1)}},X=async t=>{if(t.preventDefault(),j(!0),!m||!u||m===u){n("Please select two different participants","error"),j(!1);return}if(k.length!==1){n("Please ensure the outcome is generated","error"),j(!1);return}const a=l.find(d=>d.id===m),s=l.find(d=>d.id===u);if(!a||!s){n("Invalid participant selected","error"),j(!1);return}const c=`${a.name} Over ${s.name}`,i=`H2H-${a.name.split(" ").map(d=>d[0]).join("")}-${s.name.split(" ").map(d=>d[0]).join("")}`.replace(/\s/g,"").toUpperCase().slice(0,12),h=w(a.name),Z=w(s.name);try{await P.suggestMarket({short_name:c,symbol:i||"H2H",max_winners:1,min_winners:1,outcomes:k.map(d=>({name:d.name.trim(),ticker:d.ticker.trim(),strike:d.strike.trim()||void 0,outcome_id:`outcome-h2h-${h}-${Z}`}))}),n("Head-to-Head suggestion submitted successfully!","success"),E(""),I(""),$([])}catch(d){console.error("Failed to submit Head-to-Head suggestion:",d),n(d.message||"Failed to submit suggestion","error")}finally{j(!1)}};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(W,{toasts:G,removeToast:V}),e.jsx("h1",{className:"text-xl sm:text-2xl font-bold",children:"Market Suggestions"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400",children:"Create Round Over/Under, Total Birdies, or Head-to-Head matchup outcomes."}),e.jsxs("form",{onSubmit:z,className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 sm:p-6 rounded-lg space-y-4",children:[e.jsx("h2",{className:"text-base sm:text-lg font-bold",children:"Round Over/Under Market"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Create a Round Over/Under outcome by selecting a participant, round, and strike."}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"round_number",className:"block text-sm font-medium mb-1.5",children:["Round # ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"round_number",value:o,onChange:t=>C(parseInt(t.target.value,10)),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm sm:text-base",children:[e.jsx("option",{value:1,children:"Round 1"}),e.jsx("option",{value:2,children:"Round 2"}),e.jsx("option",{value:3,children:"Round 3"}),e.jsx("option",{value:4,children:"Round 4"}),e.jsx("option",{value:5,children:"Round 5"}),e.jsx("option",{value:6,children:"Round 6"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"participant",className:"block text-sm font-medium mb-1.5",children:["Participant ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"participant",value:b,onChange:t=>F(t.target.value),required:!0,disabled:v,className:"w-full px-4 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 min-h-[44px] touch-manipulation disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Select participant..."}),l.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"strike",className:"block text-sm font-medium mb-1.5",children:["Strike ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"strike",type:"text",value:p,onChange:t=>B(t.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm sm:text-base",placeholder:"e.g., 86.5"})]})]}),b&&o&&p.trim()&&N.length===1&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-2",children:"Generated Outcome:"}),e.jsx("ul",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1",children:N.map((t,a)=>e.jsxs("li",{children:["• ",t.name," (",t.ticker,")"]},a))})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:H,className:"px-4 sm:px-6 py-2 sm:py-3 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base font-medium touch-manipulation",children:H?"Submitting...":"Submit Round O/U"})})]}),e.jsxs("form",{onSubmit:L,className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 sm:p-6 rounded-lg space-y-4",children:[e.jsx("h2",{className:"text-base sm:text-lg font-bold",children:"Total Birdies Market"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Create a Total Birdies outcome for the whole event (all rounds). Select participant and strike."}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"tb_participant",className:"block text-sm font-medium mb-1.5",children:["Participant ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"tb_participant",value:g,onChange:t=>M(t.target.value),required:!0,disabled:v,className:"w-full px-4 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 min-h-[44px] touch-manipulation disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Select participant..."}),l.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"tb_strike",className:"block text-sm font-medium mb-1.5",children:["Strike (birdies) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"tb_strike",type:"text",value:x,onChange:t=>q(t.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm sm:text-base",placeholder:"e.g., 3"})]})]}),g&&x.trim()&&S.length===1&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-2",children:"Generated Outcome:"}),e.jsx("ul",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1",children:S.map((t,a)=>e.jsxs("li",{children:["• ",t.name," (",t.ticker,")"]},a))})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:R,className:"px-4 sm:px-6 py-2 sm:py-3 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base font-medium touch-manipulation",children:R?"Submitting...":"Submit Total Birdies"})})]}),e.jsxs("form",{onSubmit:X,className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 sm:p-6 rounded-lg space-y-4",children:[e.jsx("h2",{className:"text-base sm:text-lg font-bold",children:"Head-to-Head Matchup"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:'Create a matchup market: Participant 1 Over Participant 2. Select two participants; the first is "Over" the second.'}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"h2h_participant1",className:"block text-sm font-medium mb-1.5",children:["Participant 1 (Over) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"h2h_participant1",value:m,onChange:t=>E(t.target.value),required:!0,disabled:v,className:"w-full px-4 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 min-h-[44px] touch-manipulation disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Select participant..."}),l.map(t=>e.jsx("option",{value:t.id,disabled:t.id===u,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"h2h_participant2",className:"block text-sm font-medium mb-1.5",children:["Participant 2 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"h2h_participant2",value:u,onChange:t=>I(t.target.value),required:!0,disabled:v,className:"w-full px-4 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 min-h-[44px] touch-manipulation disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Select participant..."}),l.map(t=>e.jsx("option",{value:t.id,disabled:t.id===m,children:t.name},t.id))]})]})]}),k.length===1&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-2",children:"Generated outcome:"}),e.jsx("ul",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1",children:k.map((t,a)=>e.jsxs("li",{children:["• ",t.name," (",t.ticker,")"]},a))})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:D||k.length!==1,className:"px-4 sm:px-6 py-2 sm:py-3 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base font-medium touch-manipulation",children:D?"Submitting...":"Submit Head-to-Head"})})]})]})}export{te as MarketSuggestionsPage};

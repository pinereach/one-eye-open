import{r as l,j as e,d as it,a as lt,u as dt,b as I}from"./index-ctqCthlT.js";import{f as H,a as R,b as Re,c as V,d as he}from"./format-CS6GGukx.js";import{u as ct,T as ot}from"./Toast-Bu89sGOq.js";import{C as ve}from"./ConfirmModal-BDmXBGBq.js";import{P as mt}from"./PullToRefresh-JQ5slNZt.js";import{S as qe}from"./Skeleton-TBYkA0ns.js";import{C as Ye,b as He}from"./Card-DlpZWXVl.js";import{f as We}from"./index-BAgxTVAR.js";function xt({isOpen:y,orders:M,price:P,onClose:d,onCancel:v}){const g=p=>new Date(p*1e3).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0});return y?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold",children:"Cancel Order"}),e.jsx("button",{onClick:d,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-xl font-bold",children:"×"})]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["You have multiple orders at ",H(P),". Select which one to cancel:"]}),e.jsx("div",{className:"space-y-2",children:M.map(p=>e.jsx("button",{onClick:()=>{v(p.id),d()},className:"w-full text-left p-3 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-sm sm:text-base",children:[p.contract_size||0," contracts"]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:p.create_time?g(p.create_time):"—"})]}),e.jsx("div",{className:"text-xs sm:text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded ${p.status==="open"?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200":p.status==="partial"?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}`,children:p.status})})]})},p.id))}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:d,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:"Cancel"})})]})})}):null}function Ne({bids:y,asks:M,userId:P,onPriceClick:d,onCancelOrder:v}){const[g,p]=l.useState({isOpen:!1,orders:[],price:0}),q=c=>{const j=new Map;return c.forEach(m=>{const f=m.price||0;j.has(f)||j.set(f,{price:f,totalSize:0,orders:[],userOrders:[]});const i=j.get(f);i.orders.push(m),i.totalSize+=m.contract_size||0,P!==void 0&&m.user_id===P&&i.userOrders.push(m)}),Array.from(j.values()).sort((m,f)=>f.price-m.price)},h=c=>{const j=new Map;return c.forEach(m=>{const f=m.price||0;j.has(f)||j.set(f,{price:f,totalSize:0,orders:[],userOrders:[]});const i=j.get(f);i.orders.push(m),i.totalSize+=m.contract_size||0,P!==void 0&&m.user_id===P&&i.userOrders.push(m)}),Array.from(j.values()).sort((m,f)=>m.price-f.price)},_=q(y),k=h(M),C=c=>{let j=0;return c.map(m=>(j+=m.totalSize,{...m,cumulative:j}))},A=C(_),Q=C(k),F=Math.max(...A.map(c=>c.cumulative),...Q.map(c=>c.cumulative),1),G=c=>{const j=c.userOrders.filter(m=>m.status==="open"||m.status==="partial");j.length!==0&&(j.length===1?v&&v(j[0].id):p({isOpen:!0,orders:j,price:c.price}))};return e.jsxs(e.Fragment,{children:[e.jsx(xt,{isOpen:g.isOpen,orders:g.orders,price:g.price,onClose:()=>p({isOpen:!1,orders:[],price:0}),onCancel:c=>{v&&v(c)}}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold mb-2 text-sm sm:text-base text-green-600 dark:text-green-400",children:"Yes/Buy"}),e.jsx("div",{className:"space-y-1",children:_.length===0?e.jsx("div",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 py-4 text-center",children:"No bids"}):A.map(c=>{const j=c.cumulative/F*100,m=c.userOrders.length>0,f=c.userOrders.filter(b=>b.status==="open"||b.status==="partial"),i=m&&f.length>0,z=f.reduce((b,T)=>b+(T.contract_size??0),0),D=m&&z>0&&c.orders.length>1;return e.jsxs("div",{className:`relative flex items-center justify-between text-xs sm:text-sm p-2 rounded transition-colors touch-manipulation min-h-12 max-h-12 h-12 shrink-0 ${m?"bg-green-100 dark:bg-green-900/40 border-2 border-primary-500 dark:border-primary-400":"bg-green-50 dark:bg-green-900/20 hover:bg-green-100 dark:hover:bg-green-900/30 cursor-pointer"}`,onClick:()=>!m&&d?.(c.price,"bid"),children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 bg-green-200 dark:bg-green-800/40 rounded opacity-30",style:{width:`${j}%`}}),e.jsxs("div",{className:"relative z-10 flex items-center gap-1 flex-1 min-w-0",children:[m&&e.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-primary-600 dark:text-primary-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:b=>{b.stopPropagation(),i&&G(c)},children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-medium truncate",children:H(c.price)})]}),e.jsxs("div",{className:"relative z-10 flex items-center gap-2 min-w-0 shrink-0",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400 whitespace-nowrap truncate",children:[c.totalSize,D&&e.jsxs("span",{className:"text-primary-600 dark:text-primary-400 ml-0.5",children:["(",z," mine)"]})]}),i&&e.jsx("button",{onClick:b=>{b.stopPropagation(),G(c)},className:"text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 text-xs sm:text-sm font-bold px-1 py-0.5 rounded touch-manipulation flex-shrink-0",title:f.length>1?`Cancel order (${f.length} at this price)`:"Cancel order","aria-label":"Cancel order",children:"×"})]})]},c.price)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold mb-2 text-sm sm:text-base text-red-600 dark:text-red-400",children:"No/Sell"}),e.jsx("div",{className:"space-y-1",children:k.length===0?e.jsx("div",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 py-4 text-center",children:"No asks"}):Q.map(c=>{const j=c.cumulative/F*100,m=c.userOrders.length>0,f=c.userOrders.filter(b=>b.status==="open"||b.status==="partial"),i=m&&f.length>0,z=f.reduce((b,T)=>b+(T.contract_size??0),0),D=m&&z>0&&c.orders.length>1;return e.jsxs("div",{className:`relative flex items-center justify-between text-xs sm:text-sm p-2 rounded transition-colors touch-manipulation min-h-12 max-h-12 h-12 shrink-0 ${m?"bg-red-100 dark:bg-red-900/40 border-2 border-primary-500 dark:border-primary-400":"bg-red-50 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/30 cursor-pointer"}`,onClick:()=>!m&&d?.(c.price,"ask"),children:[e.jsx("div",{className:"absolute right-0 top-0 bottom-0 bg-red-200 dark:bg-red-800/40 rounded opacity-30",style:{width:`${j}%`}}),e.jsxs("div",{className:"relative z-10 flex items-center gap-1 flex-1 min-w-0",children:[m&&e.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-primary-600 dark:text-primary-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:b=>{b.stopPropagation(),i&&G(c)},children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-medium truncate",children:H(c.price)})]}),e.jsxs("div",{className:"relative z-10 flex items-center gap-2 min-w-0 shrink-0",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400 whitespace-nowrap truncate",children:[c.totalSize,D&&e.jsxs("span",{className:"text-primary-600 dark:text-primary-400 ml-0.5",children:["(",z," mine)"]})]}),i&&e.jsx("button",{onClick:b=>{b.stopPropagation(),G(c)},className:"text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 text-xs sm:text-sm font-bold px-1 py-0.5 rounded touch-manipulation flex-shrink-0",title:f.length>1?`Cancel order (${f.length} at this price)`:"Cancel order","aria-label":"Cancel order",children:"×"})]})]},c.price)})})]})]})})]})}const Ue='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';function ut({isOpen:y,onClose:M,children:P,title:d}){const v=l.useRef(null),g=l.useRef(null),p=l.useRef(null),q=l.useCallback(()=>{const h=v.current,_=g.current;if(h&&_){const k=h.getBoundingClientRect(),C=_.getBoundingClientRect();if(k.width>0&&k.height>0)return h;if(C.width>0&&C.height>0)return _}return h??_},[]);return l.useEffect(()=>(y?(document.body.style.overflow="hidden",p.current=document.activeElement):(document.body.style.overflow="",p.current&&typeof p.current.focus=="function"&&(p.current.focus(),p.current=null)),()=>{document.body.style.overflow=""}),[y]),l.useEffect(()=>{if(!y)return;const h=_=>{if(_.key==="Escape"){M();return}if(_.key!=="Tab")return;const k=q();if(!k)return;const C=Array.from(k.querySelectorAll(Ue)).filter(F=>!F.hasAttribute("disabled")&&F.offsetParent!=null);if(C.length===0)return;const A=C[0],Q=C[C.length-1];_.shiftKey?document.activeElement===A&&(_.preventDefault(),Q.focus()):document.activeElement===Q&&(_.preventDefault(),A.focus())};return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[y,M,q]),l.useEffect(()=>{if(!y)return;const h=q();if(!h)return;const _=h.querySelector(Ue),k=requestAnimationFrame(()=>{_&&_.focus()});return()=>cancelAnimationFrame(k)},[y,q]),y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:M,"aria-hidden":"true"}),e.jsxs("div",{ref:v,className:"fixed bottom-0 left-0 right-0 z-50 md:hidden bg-white dark:bg-gray-800 rounded-t-2xl shadow-2xl max-h-[90vh] overflow-y-auto safe-area-bottom",role:"dialog","aria-modal":"true",children:[e.jsx("div",{className:"sticky top-0 bg-white dark:bg-gray-800 pt-2 pb-2 flex justify-center",children:e.jsx("div",{className:"w-12 h-1 bg-gray-300 dark:bg-gray-600 rounded-full"})}),d&&e.jsx("div",{className:"px-4 pb-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:d}),e.jsx("button",{onClick:M,className:"p-2 -mr-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 touch-manipulation min-h-[44px] min-w-[44px] flex items-center justify-center","aria-label":"Close",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"px-4 pt-4 pb-24",children:P})]}),e.jsx("div",{className:"hidden md:flex fixed inset-0 z-50 items-center justify-center p-4","aria-hidden":"true",children:e.jsxs("div",{ref:g,className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",onClick:h=>h.stopPropagation(),role:"dialog","aria-modal":"true",children:[d&&e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:d}),e.jsx("button",{onClick:M,className:"p-2 -mr-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 min-h-[44px] min-w-[44px] flex items-center justify-center","aria-label":"Close",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"px-6 py-4",children:P})]})})]}):null}function pt({tabs:y,activeTab:M,onTabChange:P,className:d=""}){return e.jsx("div",{className:`border-b border-gray-300 dark:border-gray-600 ${d}`,children:e.jsx("div",{className:"flex overflow-x-auto -mx-3 sm:mx-0 px-3 sm:px-0 scrollbar-hide",children:y.map(v=>{const g=M===v.id;return e.jsxs("button",{onClick:()=>P(v.id),className:`
                flex items-center gap-2 px-4 py-3 text-sm font-medium whitespace-nowrap
                border-b-2 transition-colors touch-manipulation min-h-[44px]
                ${g?"border-primary-600 dark:border-primary-400 text-primary-600 dark:text-primary-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:border-gray-300 dark:hover:border-gray-600"}
              `,"aria-selected":g,role:"tab",children:[v.icon&&e.jsx("span",{className:"flex-shrink-0",children:v.icon}),e.jsx("span",{children:v.label})]},v.id)})})})}const Ve="(min-width: 768px)";function ht(){const[y,M]=l.useState(()=>typeof window<"u"?window.matchMedia(Ve).matches:!1);return l.useEffect(()=>{const P=window.matchMedia(Ve),d=v=>M(v.matches);return M(P.matches),P.addEventListener("change",d),()=>P.removeEventListener("change",d)},[]),y}function _t(){const{id:y}=it(),M=lt(),{toasts:P,showToast:d,removeToast:v}=ct(),{user:g}=dt(),[p,q]=l.useState(null),[h,_]=l.useState([]),[k,C]=l.useState(""),[A,Q]=l.useState({}),[F,G]=l.useState([]),[c,j]=l.useState([]),[m,f]=l.useState(!0),[i,z]=l.useState("bid"),[D,b]=l.useState(""),[T,te]=l.useState(""),[le,re]=l.useState(""),[de,se]=l.useState(""),[ce,oe]=l.useState(!1),[ge,Y]=l.useState(null),[ae,J]=l.useState(!1),[X,be]=l.useState(!1),[K,Qe]=l.useState("outcomes"),[we,_e]=l.useState(null),[me,Ce]=l.useState(!1),[ye,Pe]=l.useState(null),[Ke,Oe]=l.useState(!1),[Ge,ke]=l.useState(!1),[Je,Se]=l.useState(!1),[E,ne]=l.useState({}),Me=ht(),fe=l.useRef(null),je=l.useRef(0),[$e,Xe]=l.useState(null),Be=12e4;function Ze(t){const r=Math.floor((Date.now()-t)/1e3);if(r<10)return"just now";if(r<60)return`${r} sec ago`;const a=Math.floor(r/60);return a<60?`${a} min ago`:`${Math.floor(a/60)} hr ago`}function xe(t,r){const a=t.indexOf(" Over ");if(a===-1)return r?t:e.jsx(e.Fragment,{children:t});const s=t.slice(0,a).trim(),n=t.slice(a+6).trim(),o=E[s],x=E[n],u=L=>e.jsxs("span",{className:"text-[10px] sm:text-xs text-gray-500 dark:text-gray-400 font-normal",children:[" (",L,")"]});return r?`${s}${o!=null?` (${o})`:""} Over ${n}${x!=null?` (${x})`:""}`:e.jsxs(e.Fragment,{children:[s,o!=null&&u(o)," Over ",n,x!=null&&u(x)]})}l.useEffect(()=>{y&&B()},[y]),l.useEffect(()=>{g&&!g.view_market_maker&&i==="market_maker"&&z("bid")},[g?.view_market_maker,i]),l.useEffect(()=>{ae&&fe.current&&setTimeout(()=>{fe.current?.focus()},100)},[ae]),l.useEffect(()=>{ae&&y&&Date.now()-je.current>=Be&&B()},[ae,y]),l.useEffect(()=>{const t=()=>{document.visibilityState==="visible"&&y&&Date.now()-je.current>=Be&&B()};return document.addEventListener("visibilitychange",t),()=>document.removeEventListener("visibilitychange",t)},[y]);async function B(){if(y){f(!0);try{const t=await I.getMarket(y);if(q(t?.market||null),_(t?.outcomes||[]),Q(t?.orderbook||{}),G(t?.trades??[]),j(t?.positions??[]),t?.market?.market_id==="market-individual-net-champion"||t?.market?.market_id==="market-h2h-matchups"?I.getHandicaps(2026).then(a=>{const s=("handicaps"in a?a.handicaps:{})??{};Object.keys(s).length>0?ne(s):I.getHandicaps(2025).then(n=>ne(("handicaps"in n?n.handicaps:{})??{})).catch(()=>ne({}))}).catch(()=>ne({})):ne({}),t.outcomes&&t.outcomes.length>0&&t.orderbook){const a=[...t.outcomes].sort((s,n)=>{const o=t.orderbook[s.outcome_id],x=t.orderbook[n.outcome_id],u=o?.bids?.[0],L=o?.asks?.[0],N=x?.bids?.[0],ee=x?.asks?.[0],nt=u&&L?(u.price+L.price)/2:u?.price||0;return(N&&ee?(N.price+ee.price)/2:N?.price||0)-nt});!k&&a.length>0&&C(a[0].outcome_id)}}catch(t){console.error("Failed to load market:",t),d("Failed to load market data","error")}finally{f(!1),je.current=Date.now(),Xe(Date.now())}}}async function Ae(t){if(t.preventDefault(),!y||!k){d("Please select an outcome","error");return}const r=parseInt(T,10);if(isNaN(r)||r<=0){d("Quantity must be at least 1","error");return}if(i==="market_maker"){const o=parseInt(le,10),x=parseInt(de,10);if(isNaN(o)||o<1||o>99){d("Bid price must be a whole number between $1 and $99","error");return}if(isNaN(x)||x<1||x>99){d("Ask price must be a whole number between $1 and $99","error");return}if(o>=x){d("Bid price must be less than ask price","error");return}oe(!0);try{await I.placeOrder(y,{outcome_id:k,side:"bid",price:o*100,contract_size:r,tif:"GTC"}),await I.placeOrder(y,{outcome_id:k,side:"ask",price:x*100,contract_size:r,tif:"GTC"}),te(""),re(""),se(""),d("Bid and ask placed","success"),await new Promise(u=>setTimeout(u,200)),await B(),J(!1)}catch(u){d(u?.message||"Failed to place orders","error"),await B(),d("Orderbook refreshed – please try again if needed.","info")}finally{oe(!1)}return}const a=parseInt(D,10);if(isNaN(a)||a<1||a>99){d("Price must be a whole number between $1 and $99","error");return}const s=a*100,n=k&&A?.[k]||null;if(n&&g?.id){if(i==="bid"){if(n.asks.filter(x=>x.user_id===g.id&&(x.status==="open"||x.status==="partial")&&x.price<=s).length>0){d("Cannot place bid: You have existing sell orders at this price or better","error");return}}else if(n.bids.filter(x=>x.user_id===g.id&&(x.status==="open"||x.status==="partial")&&x.price>=s).length>0){d("Cannot place ask: You have existing buy orders at this price or better","error");return}}oe(!0);try{await I.placeOrder(y,{outcome_id:k,side:i,price:s,contract_size:r,tif:"GTC"}),b(""),te(""),Y(null),d("Order placed successfully!","success"),await new Promise(o=>setTimeout(o,200)),await Promise.all([B()])}catch(o){d(o.message||"Failed to place order","error"),await B(),d("Orderbook refreshed – please try again if needed.","info")}finally{oe(!1)}}function Le(t,r){if(C(t),z("bid"),r){const a=Math.round(r/100),s=Math.max(1,Math.min(99,a));b(s.toString()),Y("price"),setTimeout(()=>Y(null),2e3)}J(!0)}function ze(t,r){if(C(t),z("ask"),r){const a=Math.round(r/100),s=Math.max(1,Math.min(99,a));b(s.toString()),Y("price"),setTimeout(()=>Y(null),2e3)}J(!0)}function Z(t){if(z(t),w){if(t==="bid"&&O){const r=Math.round(O.price/100),a=Math.max(1,Math.min(99,r));b(a.toString())}else if(t==="ask"&&S){const r=Math.round(S.price/100),a=Math.max(1,Math.min(99,r));b(a.toString())}else if(t==="market_maker"&&(O||S)){if(O){const r=Math.max(1,Math.min(99,Math.round(O.price/100)));re(r.toString())}if(S){const r=Math.max(1,Math.min(99,Math.round(S.price/100)));se(r.toString())}}}}const et=(()=>{const t=(F||[]).reduce((a,s)=>a+(s.contracts||0),0),r=t*200;return{volume_contracts:t,volume_dollars:r}})(),$=(()=>{const t=parseInt(D,10)||0,r=parseInt(T,10)||0,a=parseInt(le,10)||0,s=parseInt(de,10)||0;return{totalCost:i==="market_maker"?0:i==="bid"?t*r:r*(100-t),price:t,qty:r,mmBidPrice:a,mmAskPrice:s}})(),w=k&&A?.[k]||null,O=w?.bids?.[0],S=w?.asks?.[0];function Fe(t){const r=t.market_name??p?.short_name??"N/A",a=h?.find(n=>n.outcome_id===t.outcome),s=t.outcome_ticker??t.outcome_name??a?.name??a?.ticker??t.outcome;return{marketName:r,outcomeLabel:s}}const W=(c||[]).reduce((t,r)=>(t[r.outcome]={net_position:r.net_position,price_basis:r.price_basis},t),{}),ue=l.useMemo(()=>(c||[]).filter(t=>t.net_position!==0||(t.closed_profit??0)!==0||(t.settled_profit??0)!==0),[c]),pe=(t,r)=>{const a=t>=0?"+":"",s=(r/100).toFixed(1);return`${a}${t} @ $${s}`},Ie=(t,r)=>r===null?null:t.net_position<0?(1e4-r)*Math.abs(t.net_position):t.net_position*r,U=l.useMemo(()=>{if(!g?.id||!(K==="orders"||Me))return[];const t=[];for(const r of Object.values(A))for(const a of[...r.bids||[],...r.asks||[]])a.user_id===g.id&&(a.status==="open"||a.status==="partial")&&t.push(a);return t},[K,Me,A,g?.id]),ie=l.useMemo(()=>!g?.id||!w?[]:[...w.bids||[],...w.asks||[]].filter(r=>r.user_id===g.id&&(r.status==="open"||r.status==="partial")),[g?.id,w]);async function tt(t){_e(t);try{await I.cancelOrder(t),d("Order canceled successfully","success"),await B()}catch(r){console.error("Failed to cancel order:",r),d(r.message||"Failed to cancel order","error")}finally{_e(null)}}function De(t){Pe(t)}async function rt(){if(U.length!==0){Ce(!0);try{for(const t of U)await I.cancelOrder(t.id);d("All orders in this market canceled","success"),await B()}catch(t){console.error("Failed to cancel orders:",t),d(t.message||"Failed to cancel some orders","error")}finally{Ce(!1)}}}function Te(){Oe(!0)}async function st(){if(ie.length!==0){Se(!0),ke(!1);try{for(const t of ie)await I.cancelOrder(t.id);d(`Canceled ${ie.length} order(s) for this outcome`,"success"),await B()}catch(t){console.error("Failed to cancel orders for outcome:",t),d(t?.message||"Failed to cancel some orders","error")}finally{Se(!1)}}}function at(){ke(!0)}if(m)return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(qe,{variant:"text",width:"200px",height:"32px"}),e.jsx(qe,{variant:"rectangular",height:"400px",className:"rounded-lg"})]});if(!p)return e.jsx("div",{className:"text-center py-8",children:"Market not found"});const Ee=(h||[]).length>0?[...h||[]].sort((t,r)=>{const a=A?.[t.outcome_id],s=A?.[r.outcome_id],n=a?.bids?.[0],o=a?.asks?.[0],x=s?.bids?.[0],u=s?.asks?.[0],L=n&&o?(n.price+o.price)/2:n?.price||0;return(x&&u?(x.price+u.price)/2:x?.price||0)-L}):[];return e.jsx(mt,{onRefresh:B,children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(ot,{toasts:P,removeToast:v}),e.jsx("div",{className:"flex items-center gap-2 sm:gap-4",children:e.jsxs("button",{onClick:()=>M("/markets"),className:"flex items-center gap-2 px-3 sm:px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-800 transition touch-manipulation",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),e.jsx("span",{className:"hidden sm:inline",children:"Back to Markets"}),e.jsx("span",{className:"sm:hidden",children:"Back"})]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold mb-3 sm:mb-4",children:p.short_name}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 gap-3 sm:gap-4 mb-4 sm:mb-6",children:e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 sm:p-4 rounded-lg",children:[e.jsx("div",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Trading Volume"}),e.jsxs("div",{className:"text-sm sm:text-lg font-semibold",children:["$",et.volume_dollars.toLocaleString()]})]})}),$e!=null&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mb-2",children:[e.jsxs("span",{children:["Updated ",Ze($e)]}),e.jsx("button",{type:"button",onClick:()=>B(),className:"text-primary-600 dark:text-primary-400 hover:underline font-medium",children:"Refresh"})]})]}),e.jsx("div",{className:"md:hidden",children:e.jsx(pt,{tabs:[{id:"outcomes",label:"Outcomes"},{id:"orders",label:"Orders"},{id:"trades",label:"Trades"},{id:"positions",label:"Positions"}],activeTab:K,onTabChange:t=>Qe(t)})}),e.jsxs("div",{className:"md:hidden",children:[K==="outcomes"&&h&&h.length>0&&e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"overflow-x-auto -mx-3 sm:mx-0",children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:e.jsxs("table",{className:"w-full min-w-[320px] sm:min-w-[640px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-300 dark:border-gray-600",children:[e.jsx("th",{className:"py-1.5 px-2 sm:py-2 sm:px-3 text-left text-xs font-bold text-gray-600 dark:text-gray-400",children:"Team"}),e.jsx("th",{className:"py-1.5 px-1 sm:py-2 sm:px-3 text-center text-xs font-bold text-gray-600 dark:text-gray-400",children:"Chance"}),e.jsx("th",{className:"py-1.5 px-1 sm:py-2 sm:px-3 text-center text-xs font-bold text-gray-600 dark:text-gray-400",children:"No/Sell"}),e.jsx("th",{className:"py-1.5 px-1 sm:py-2 sm:px-3 text-center text-xs font-bold text-gray-600 dark:text-gray-400",children:"Yes/Buy"})]})}),e.jsx("tbody",{children:Ee.map((t,r)=>{const a=A[t.outcome_id],s=a?.bids?.[0],n=a?.asks?.[0],o=s?s.price:null,x=s&&n?(s.price+n.price)/2:o||0,u=x?Math.round(x/1e4*100):0,L=k===t.outcome_id;return e.jsxs("tr",{className:`border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer touch-manipulation transition-colors ${L?"bg-primary-50 dark:bg-primary-900/20 border-l-4 border-l-primary-600 dark:border-l-primary-400":""}`,onClick:()=>C(t.outcome_id),children:[e.jsx("td",{className:"py-1.5 px-2 sm:py-2 sm:px-3",children:e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 w-4 sm:w-6 flex-shrink-0",children:r+1}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium text-xs sm:text-sm text-gray-900 dark:text-gray-100 truncate",children:p?.market_id==="market-h2h-matchups"?xe(t.name,!1):e.jsxs(e.Fragment,{children:[t.name,p?.market_id==="market-individual-net-champion"&&E[t.name]!=null&&e.jsxs("span",{className:"text-[10px] sm:text-xs text-gray-500 dark:text-gray-400 font-normal",children:[" (",E[t.name],")"]})]})}),W[t.outcome_id]&&(()=>{const{net_position:N}=W[t.outcome_id],ee=N>0;return e.jsx("span",{className:`inline-block mt-0.5 px-1.5 py-0.5 rounded text-[10px] sm:text-xs font-bold ${ee?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400"}`,children:pe(W[t.outcome_id].net_position,W[t.outcome_id].price_basis)})})()]})]})}),e.jsx("td",{className:"py-1.5 px-1 sm:py-2 sm:px-3 text-center",children:e.jsxs("span",{className:"font-medium text-xs sm:text-sm text-gray-900 dark:text-gray-100",children:[u,"%"]})}),e.jsx("td",{className:"py-1.5 px-1 sm:py-2 sm:px-3 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:N=>{N.stopPropagation(),ze(t.outcome_id,s?.price||null)},className:"w-[60px] sm:w-[100px] px-1 sm:px-2 py-1 sm:py-1.5 rounded text-xs font-bold whitespace-nowrap bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 hover:bg-purple-200 dark:hover:bg-purple-800 active:bg-purple-300 dark:active:bg-purple-700 touch-manipulation min-h-[44px] flex flex-col items-center justify-center transition-colors",children:[s?R(s.price):"-",s?.contract_size!=null&&s.contract_size>0&&e.jsxs("span",{className:"text-[10px] sm:text-xs font-normal opacity-90 mt-0.5",children:["x ",s.contract_size]})]})})}),e.jsx("td",{className:"py-1.5 px-1 sm:py-2 sm:px-3 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:N=>{N.stopPropagation(),Le(t.outcome_id,n?.price||null)},className:"w-[60px] sm:w-[100px] px-1 sm:px-2 py-1 sm:py-1.5 rounded text-xs font-bold whitespace-nowrap bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-800 active:bg-blue-300 dark:active:bg-blue-700 touch-manipulation min-h-[44px] flex flex-col items-center justify-center transition-colors",children:[n?R(n.price):"-",n?.contract_size!=null&&n.contract_size>0&&e.jsxs("span",{className:"text-[10px] sm:text-xs font-normal opacity-90 mt-0.5",children:["x ",n.contract_size]})]})})})]},t.id)})})]})})})}),K==="orders"&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3",children:[e.jsx("h2",{className:"text-base font-bold",children:"Your open orders"}),U.length>0&&e.jsx("button",{type:"button",onClick:Te,disabled:me,className:"px-3 py-1.5 text-sm font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded border border-red-300 dark:border-red-700 disabled:opacity-50",children:me?"Canceling…":"Cancel all"})]}),U.length===0?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 py-8 text-center",children:"No open orders in this market. Place orders from the Outcomes tab."}):e.jsx("div",{className:"space-y-2",children:U.map(t=>{const r=h?.find(o=>o.outcome_id===t.outcome)?.name??t.outcome,a=t.side===0?"Yes/Buy":"No/Sell",s=t.remaining_size??t.contract_size??0,n=we===t.id;return e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 border border-gray-200 dark:border-gray-600 rounded-lg text-sm",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100 truncate min-w-0 flex-1",children:r}),e.jsx("span",{className:`flex-shrink-0 px-2 py-0.5 rounded text-xs font-bold ${t.side===0?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300"}`,children:a}),e.jsxs("span",{className:"flex-shrink-0 text-gray-600 dark:text-gray-400",children:[R(t.price)," × ",s]}),e.jsx("button",{type:"button",onClick:()=>De(t.id),disabled:n,title:"Cancel order","aria-label":"Cancel order",className:"flex-shrink-0 px-2 py-1 text-lg font-bold text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded disabled:opacity-50 touch-manipulation",children:"×"})]},t.id)})})]}),K==="trades"&&e.jsx("div",{className:"mt-4",children:m?e.jsx("div",{className:"animate-pulse space-y-2",children:[1,2,3].map(t=>e.jsx("div",{className:"h-12 bg-gray-200 dark:bg-gray-700 rounded"},t))}):F.length===0?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 py-8 text-center",children:"No recent trades"}):e.jsx("div",{className:"space-y-2",children:F.map(t=>{const r=t.taker_side??t.side,a=r===0,s=r===1,n=a?"Buy":s?"Sell":"—",o=a?"bg-green-600 text-white dark:bg-green-500 dark:text-white":s?"bg-red-600 text-white dark:bg-red-500 dark:text-white":"bg-gray-400 text-white dark:bg-gray-500 dark:text-white";return e.jsxs("div",{className:"flex items-center gap-3 p-3 border border-gray-300 dark:border-gray-600 rounded text-sm",children:[e.jsx("span",{className:`flex-shrink-0 px-3 py-1 rounded-md text-sm font-bold uppercase ${o}`,"aria-label":n!=="—"?n:"Unknown side",children:n}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[t.outcome_ticker&&e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:t.outcome_ticker}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400 flex-shrink-0",children:[t.contracts," @ ",H(t.price)]}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 font-medium flex-shrink-0",children:Re(t.price,t.contracts,t.taker_side??t.side??0)})]}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400 text-xs whitespace-nowrap flex-shrink-0",children:t.create_time?We(new Date(t.create_time*1e3),"M/d h:mm a"):"—"})]},t.id)})})}),K==="positions"&&e.jsx("div",{className:"mt-4",children:m?e.jsx("div",{className:"animate-pulse space-y-2",children:[1,2].map(t=>e.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-lg"},t))}):ue.length===0?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 py-8 text-center",children:"No positions"}):e.jsx("div",{className:"space-y-3",children:ue.map(t=>{const r=t.net_position!==0,{marketName:a,outcomeLabel:s}=Fe(t),n=t.current_price!==null&&t.current_price!==void 0?t.current_price:null,o=t.net_position*t.price_basis,x=r?Ie(t,n):null,u=r&&n!==null?t.net_position<0?(t.price_basis-n)*Math.abs(t.net_position):t.net_position*n-o:null,{riskCents:L,toProfitCents:N}=t.net_position<0?{riskCents:(1e4-t.price_basis)*Math.abs(t.net_position),toProfitCents:t.price_basis*Math.abs(t.net_position)}:{riskCents:t.price_basis*t.net_position,toProfitCents:(1e4-t.price_basis)*t.net_position};return e.jsx(Ye,{className:"mb-3",children:e.jsxs(He,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[e.jsx("h3",{className:"font-bold text-base sm:text-lg text-gray-900 dark:text-gray-100 mb-1",children:a}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 mb-2",children:s}),r&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-bold ${t.net_position>0?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400"}`,children:pe(t.net_position,t.price_basis)}),e.jsxs("p",{className:"mt-1.5 text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:["Risk: ",e.jsx("span",{className:"font-medium text-red-600 dark:text-red-400",children:V(L)})," | ","To Profit: ",e.jsx("span",{className:"font-medium text-green-600 dark:text-green-400",children:V(N)})]})]})]}),r&&e.jsxs("div",{className:"flex flex-col items-end text-right",children:[e.jsx("div",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-gray-100 mb-1",children:x!==null?he(x):he(o)}),e.jsx("div",{className:`text-sm sm:text-base font-semibold ${u!==null?u>0?"text-green-600 dark:text-green-400":u<0?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400":"text-gray-600 dark:text-gray-400"}`,children:u!==null?e.jsxs(e.Fragment,{children:[u>0?"↑":u<0?"↓":""," ",H(Math.abs(u))]}):"—"})]})]}),t.closed_profit!=null&&t.closed_profit!==0||t.settled_profit!=null&&t.settled_profit!==0?e.jsxs("div",{className:"mt-3 -mx-4 sm:-mx-5 -mb-4 sm:-mb-5 px-4 sm:px-5 py-2 rounded-b-lg bg-gray-100 dark:bg-gray-800/80 border-t border-gray-200 dark:border-gray-700 flex flex-wrap gap-x-4 gap-y-1 text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{children:["Closed profit: ",e.jsx("span",{className:`font-medium ${(t.closed_profit??0)>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:V(t.closed_profit??0)})]}),e.jsxs("span",{children:["Settled profit: ",e.jsx("span",{className:`font-medium ${(t.settled_profit??0)>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:V(t.settled_profit??0)})]})]}):null]})},t.id)})})})]}),e.jsxs("div",{className:"hidden md:block",children:[h&&h.length>0?e.jsx("div",{children:e.jsx("div",{className:"overflow-x-auto -mx-3 sm:mx-0",children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:e.jsxs("table",{className:"w-full min-w-[320px] sm:min-w-[640px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-300 dark:border-gray-600",children:[e.jsx("th",{className:"py-1.5 px-2 sm:py-2 sm:px-3 text-left text-xs font-bold text-gray-600 dark:text-gray-400",children:"Team"}),e.jsx("th",{className:"py-1.5 px-1 sm:py-2 sm:px-3 text-center text-xs font-bold text-gray-600 dark:text-gray-400",children:"Chance"}),e.jsx("th",{className:"py-1.5 px-1 sm:py-2 sm:px-3 text-center text-xs font-bold text-gray-600 dark:text-gray-400",children:"No/Sell"}),e.jsx("th",{className:"py-1.5 px-1 sm:py-2 sm:px-3 text-center text-xs font-bold text-gray-600 dark:text-gray-400",children:"Yes/Buy"})]})}),e.jsx("tbody",{children:Ee.map((t,r)=>{const a=A[t.outcome_id],s=a?.bids?.[0],n=a?.asks?.[0],o=s?s.price:null,x=s&&n?(s.price+n.price)/2:o||0,u=x?Math.round(x/1e4*100):0,L=k===t.outcome_id;return e.jsxs("tr",{className:`border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer touch-manipulation transition-colors ${L?"bg-primary-50 dark:bg-primary-900/20 border-l-4 border-l-primary-600 dark:border-l-primary-400":""}`,onClick:()=>C(t.outcome_id),children:[e.jsx("td",{className:"py-1.5 px-2 sm:py-2 sm:px-3",children:e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 w-4 sm:w-6 flex-shrink-0",children:r+1}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium text-xs sm:text-sm text-gray-900 dark:text-gray-100 truncate",children:p?.market_id==="market-h2h-matchups"?xe(t.name,!1):e.jsxs(e.Fragment,{children:[t.name,p?.market_id==="market-individual-net-champion"&&E[t.name]!=null&&e.jsxs("span",{className:"text-[10px] sm:text-xs text-gray-500 dark:text-gray-400 font-normal",children:[" (",E[t.name],")"]})]})}),W[t.outcome_id]&&(()=>{const{net_position:N}=W[t.outcome_id],ee=N>0;return e.jsx("span",{className:`inline-block mt-0.5 px-1.5 py-0.5 rounded text-[10px] sm:text-xs font-bold ${ee?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400"}`,children:pe(W[t.outcome_id].net_position,W[t.outcome_id].price_basis)})})()]})]})}),e.jsx("td",{className:"py-1.5 px-1 sm:py-2 sm:px-3 text-center",children:e.jsxs("span",{className:"font-medium text-xs sm:text-sm text-gray-900 dark:text-gray-100",children:[u,"%"]})}),e.jsx("td",{className:"py-1.5 px-1 sm:py-2 sm:px-3 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:N=>{N.stopPropagation(),ze(t.outcome_id,s?.price||null)},className:"w-[60px] sm:w-[100px] px-1 sm:px-2 py-1 sm:py-1.5 rounded text-xs font-bold whitespace-nowrap bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 hover:bg-purple-200 dark:hover:bg-purple-800 active:bg-purple-300 dark:active:bg-purple-700 touch-manipulation min-h-[44px] flex flex-col items-center justify-center transition-colors",children:[s?R(s.price):"-",s?.contract_size!=null&&s.contract_size>0&&e.jsxs("span",{className:"text-[10px] sm:text-xs font-normal opacity-90 mt-0.5",children:["x ",s.contract_size]})]})})}),e.jsx("td",{className:"py-1.5 px-1 sm:py-2 sm:px-3 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:N=>{N.stopPropagation(),Le(t.outcome_id,n?.price||null)},className:"w-[60px] sm:w-[100px] px-1 sm:px-2 py-1 sm:py-1.5 rounded text-xs font-bold whitespace-nowrap bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-800 active:bg-blue-300 dark:active:bg-blue-700 touch-manipulation min-h-[44px] flex flex-col items-center justify-center transition-colors",children:[n?R(n.price):"-",n?.contract_size!=null&&n.contract_size>0&&e.jsxs("span",{className:"text-[10px] sm:text-xs font-normal opacity-90 mt-0.5",children:["x ",n.contract_size]})]})})})]},t.id)})})]})})})}):e.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No outcomes available for this market"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 sm:gap-6 mt-6",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3 sm:mb-4",children:[e.jsx("h2",{className:"text-base sm:text-lg font-bold",children:"Orderbook"}),k&&w&&ie.length>0&&e.jsx("button",{type:"button",onClick:at,disabled:Je,className:"text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 disabled:opacity-50 p-1.5 rounded touch-manipulation font-bold text-lg leading-none",title:"Cancel all your orders for this outcome","aria-label":"Cancel all your orders for this outcome",children:"×"})]}),k&&w?e.jsx(Ne,{bids:w.bids,asks:w.asks,userId:g?.id,onPriceClick:(t,r)=>{const a=Math.round(t/100),s=Math.max(1,Math.min(99,a));b(s.toString()),z(r),Y("price"),setTimeout(()=>Y(null),2e3)},onCancelOrder:async t=>{try{await I.cancelOrder(t),d("Order canceled successfully","success"),await B()}catch(r){console.error("Failed to cancel order:",r),d(r.message||"Failed to cancel order","error")}}}):e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 py-4 text-center",children:"Select an outcome to view orderbook"})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("button",{onClick:()=>J(!0),className:`md:hidden fixed bottom-20 right-4 z-30 text-white rounded-full p-4 shadow-lg touch-manipulation min-h-[56px] min-w-[56px] flex items-center justify-center ${i==="ask"?"bg-purple-600 hover:bg-purple-700 active:bg-purple-800":i==="market_maker"?"bg-primary-600 hover:bg-primary-700 active:bg-primary-800":"bg-blue-600 hover:bg-blue-700 active:bg-blue-800"}`,"aria-label":i==="market_maker"?"Place order":i==="ask"?"Place sell order":"Place buy order",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("h2",{className:"text-base sm:text-lg font-bold mb-3 sm:mb-4",children:i==="market_maker"?"Place Order":i==="ask"?"Place Sell Order":"Place Buy Order"}),e.jsxs("form",{onSubmit:Ae,className:"space-y-3 sm:space-y-4",children:[h&&h.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1.5",children:"Outcome"}),e.jsxs("select",{value:k,onChange:t=>C(t.target.value),required:!0,className:"w-full px-3 py-2.5 text-base border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 touch-manipulation",children:[e.jsx("option",{value:"",children:"Select an outcome"}),h.map(t=>e.jsx("option",{value:t.outcome_id,children:p?.market_id==="market-h2h-matchups"?xe(t.name,!0):p?.market_id==="market-individual-net-champion"&&E[t.name]!=null?`${t.name} (${E[t.name]})`:t.name??t.ticker},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1.5",children:"Side"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>Z("ask"),className:`flex-1 min-w-0 py-3 px-4 rounded font-medium text-sm sm:text-base min-h-[44px] touch-manipulation ${i==="ask"?"bg-purple-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}`,children:["No/Sell ",O?`$${Math.round(O.price/100)}`:""]}),e.jsxs("button",{type:"button",onClick:()=>Z("bid"),className:`flex-1 min-w-0 py-3 px-4 rounded font-medium text-sm sm:text-base min-h-[44px] touch-manipulation ${i==="bid"?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}`,children:["Yes/Buy ",S?`$${Math.round(S.price/100)}`:""]}),g?.view_market_maker&&e.jsx("button",{type:"button",onClick:()=>Z("market_maker"),className:`flex-1 min-w-0 py-3 px-4 rounded font-medium text-sm sm:text-base min-h-[44px] touch-manipulation ${i==="market_maker"?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}`,children:"Market Maker"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1.5",children:"Quantity"}),e.jsx("input",{type:"tel",inputMode:"numeric",min:"1",value:T,onChange:t=>te(t.target.value),required:!0,className:"w-full px-4 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 min-h-[44px]"})]}),i==="market_maker"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1.5",children:"Bid price ($)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-600 dark:text-gray-400",children:"$"}),e.jsx("input",{type:"tel",inputMode:"numeric",pattern:"[0-9]*",min:1,max:99,value:le,onChange:t=>{const r=t.target.value;(r===""||parseInt(r,10)>=1&&parseInt(r,10)<=99)&&re(r)},placeholder:"1-99",className:"w-full pl-8 pr-4 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 min-h-[44px]"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1.5",children:"Ask price ($)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-600 dark:text-gray-400",children:"$"}),e.jsx("input",{type:"tel",inputMode:"numeric",pattern:"[0-9]*",min:1,max:99,value:de,onChange:t=>{const r=t.target.value;(r===""||parseInt(r,10)>=1&&parseInt(r,10)<=99)&&se(r)},placeholder:"1-99",className:"w-full pl-8 pr-4 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 min-h-[44px]"})]})]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1.5",children:"Price ($)"}),w&&(O||S)&&e.jsx("div",{className:"mb-2 text-xs text-gray-600 dark:text-gray-400",children:e.jsxs("span",{children:["Bid: ",O?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:R(O.price)})," × ",O.contract_size??"—"]}):"—"," | ","Ask: ",S?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-medium text-purple-600 dark:text-purple-400",children:R(S.price)})," × ",S.contract_size??"—"]}):"—"]})}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-600 dark:text-gray-400",children:"$"}),e.jsx("input",{type:"tel",inputMode:"numeric",pattern:"[0-9]*",step:"1",min:"1",max:"99",value:D,onChange:t=>{const r=t.target.value;(r===""||parseInt(r,10)>=1&&parseInt(r,10)<=99)&&(b(r),Y(null))},required:!0,className:`w-full pl-8 pr-4 py-3 text-base border rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 min-h-[44px] ${ge==="price"?"border-primary-500 ring-2 ring-primary-200 dark:ring-primary-800":"border-gray-300 dark:border-gray-600"}`})]}),ge==="price"&&e.jsx("div",{className:"text-xs text-primary-600 dark:text-primary-400 mt-1",children:"Auto-filled from table"})]}),k&&w&&e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:()=>be(t=>!t),className:"text-sm font-medium text-primary-600 dark:text-primary-400 hover:underline flex items-center gap-1",children:[X?"Hide orderbook":"View orderbook",e.jsx("svg",{className:`w-4 h-4 transition-transform ${X?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),X&&e.jsx("div",{className:"mt-2 p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-800/50 max-h-[200px] overflow-y-auto",children:e.jsx(Ne,{bids:w.bids,asks:w.asks,userId:g?.id,onPriceClick:(t,r)=>{const a=Math.round(t/100),s=Math.max(1,Math.min(99,a));b(s.toString()),z(r)},onCancelOrder:async t=>{try{await I.cancelOrder(t),d("Order canceled successfully","success"),await B()}catch(r){d(r?.message||"Failed to cancel order","error")}}})})]}),i==="market_maker"?$.qty>0&&$.mmBidPrice>0&&$.mmAskPrice>0&&e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-lg",children:e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Bid: $",$.mmBidPrice," × ",$.qty,", Ask: $",$.mmAskPrice," × ",$.qty]})}):D&&T&&e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Estimated Total:"}),e.jsx("span",{className:"text-lg font-semibold",children:H($.totalCost*100)})]})}),e.jsx("button",{type:"submit",disabled:ce,className:`w-full text-white font-medium py-3 px-4 rounded-md disabled:opacity-50 min-h-[44px] text-base touch-manipulation ${i==="ask"?"bg-purple-600 hover:bg-purple-700 active:bg-purple-800":i==="market_maker"?"bg-primary-600 hover:bg-primary-700 active:bg-primary-800":"bg-blue-600 hover:bg-blue-700 active:bg-blue-800"}`,children:ce?"Placing...":i==="market_maker"?"Place both":i==="ask"?"Place Sell Order":"Place Buy Order"})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3",children:[e.jsx("h2",{className:"text-base sm:text-lg font-bold",children:"Your open orders"}),U.length>0&&e.jsx("button",{type:"button",onClick:Te,disabled:me,className:"px-3 py-1.5 text-sm font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded border border-red-300 dark:border-red-700 disabled:opacity-50",children:me?"Canceling…":"Cancel all"})]}),U.length===0?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 py-4 text-center",children:"No open orders in this market."}):e.jsx("div",{className:"space-y-2",children:U.map(t=>{const r=h?.find(o=>o.outcome_id===t.outcome)?.name??t.outcome,a=t.side===0?"Yes/Buy":"No/Sell",s=t.remaining_size??t.contract_size??0,n=we===t.id;return e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 border border-gray-200 dark:border-gray-600 rounded-lg text-sm",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100 truncate min-w-0 flex-1",children:r}),e.jsx("span",{className:`flex-shrink-0 px-2 py-0.5 rounded text-xs font-bold ${t.side===0?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300"}`,children:a}),e.jsxs("span",{className:"flex-shrink-0 text-gray-600 dark:text-gray-400",children:[R(t.price)," × ",s]}),e.jsx("button",{type:"button",onClick:()=>De(t.id),disabled:n,title:"Cancel order","aria-label":"Cancel order",className:"flex-shrink-0 px-2 py-1 text-lg font-bold text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded disabled:opacity-50",children:"×"})]},t.id)})})]}),ue.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h2",{className:"text-base sm:text-lg font-bold mb-3 sm:mb-4",children:"Your Positions"}),m?e.jsx("div",{className:"animate-pulse space-y-2",children:[1,2].map(t=>e.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-lg"},t))}):e.jsx("div",{className:"space-y-3",children:ue.map(t=>{const r=t.net_position!==0,{marketName:a,outcomeLabel:s}=Fe(t),n=t.current_price!==null&&t.current_price!==void 0?t.current_price:null,o=t.net_position*t.price_basis,x=r?Ie(t,n):null,u=r&&n!==null?t.net_position<0?(t.price_basis-n)*Math.abs(t.net_position):t.net_position*n-o:null,{riskCents:L,toProfitCents:N}=t.net_position<0?{riskCents:(1e4-t.price_basis)*Math.abs(t.net_position),toProfitCents:t.price_basis*Math.abs(t.net_position)}:{riskCents:t.price_basis*t.net_position,toProfitCents:(1e4-t.price_basis)*t.net_position};return e.jsx(Ye,{className:"mb-3",children:e.jsxs(He,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[e.jsx("h3",{className:"font-bold text-base sm:text-lg text-gray-900 dark:text-gray-100 mb-1",children:a}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 mb-2",children:s}),r&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`inline-block px-1.5 py-0.5 rounded text-xs font-bold ${t.net_position>0?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400"}`,children:pe(t.net_position,t.price_basis)}),e.jsxs("p",{className:"mt-1.5 text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:["Risk: ",e.jsx("span",{className:"font-medium text-red-600 dark:text-red-400",children:V(L)})," | ","To Profit: ",e.jsx("span",{className:"font-medium text-green-600 dark:text-green-400",children:V(N)})]})]})]}),r&&e.jsxs("div",{className:"flex flex-col items-end text-right",children:[e.jsx("div",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-gray-100 mb-1",children:x!==null?he(x):he(o)}),e.jsx("div",{className:`text-sm sm:text-base font-semibold ${u!==null?u>0?"text-green-600 dark:text-green-400":u<0?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400":"text-gray-600 dark:text-gray-400"}`,children:u!==null?e.jsxs(e.Fragment,{children:[u>0?"↑":u<0?"↓":""," ",H(Math.abs(u))]}):"—"})]})]}),t.closed_profit!=null&&t.closed_profit!==0||t.settled_profit!=null&&t.settled_profit!==0?e.jsxs("div",{className:"mt-3 -mx-4 sm:-mx-5 -mb-4 sm:-mb-5 px-4 sm:px-5 py-2 rounded-b-lg bg-gray-100 dark:bg-gray-800/80 border-t border-gray-200 dark:border-gray-700 flex flex-wrap gap-x-4 gap-y-1 text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{children:["Closed profit: ",e.jsx("span",{className:`font-medium ${(t.closed_profit??0)>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:V(t.closed_profit??0)})]}),e.jsxs("span",{children:["Settled profit: ",e.jsx("span",{className:`font-medium ${(t.settled_profit??0)>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:V(t.settled_profit??0)})]})]}):null]})},t.id)})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h2",{className:"text-base sm:text-lg font-bold mb-3 sm:mb-4",children:"Recent Trades"}),m?e.jsx("div",{className:"animate-pulse space-y-2",children:[1,2,3].map(t=>e.jsx("div",{className:"h-12 bg-gray-200 dark:bg-gray-700 rounded"},t))}):!F||F.length===0?e.jsx("div",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 py-4 text-center",children:"No trades yet"}):e.jsx("div",{className:"space-y-2",children:F.map(t=>{const r=t.taker_side??t.side,a=r===0,s=r===1,n=a?"Buy":s?"Sell":"—",o=a?"bg-green-600 text-white dark:bg-green-500 dark:text-white":s?"bg-red-600 text-white dark:bg-red-500 dark:text-white":"bg-gray-400 text-white dark:bg-gray-500 dark:text-white";return e.jsxs("div",{className:"flex items-center gap-3 p-2 sm:p-3 border border-gray-300 dark:border-gray-600 rounded text-xs sm:text-sm",children:[e.jsx("span",{className:`flex-shrink-0 px-3 py-1 rounded-md text-xs sm:text-sm font-bold uppercase ${o}`,"aria-label":n!=="—"?n:"Unknown side",children:n}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[t.outcome_ticker&&e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:t.outcome_ticker}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400 flex-shrink-0",children:[t.contracts," @ ",H(t.price)]}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 font-medium flex-shrink-0",children:Re(t.price,t.contracts,t.taker_side??t.side??0)})]}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400 text-xs whitespace-nowrap flex-shrink-0",children:t.create_time?We(new Date(t.create_time*1e3),"M/d h:mm a"):"—"})]},t.id)})})]})]})]}),e.jsx(ut,{isOpen:ae,onClose:()=>{J(!1),b(""),te(""),re(""),se(""),be(!1)},title:i==="market_maker"?"Place Order":i==="ask"?"Place Sell Order":"Place Buy Order",children:e.jsxs("form",{onSubmit:t=>{Ae(t),J(!1)},className:"space-y-4",children:[h&&h.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Outcome"}),e.jsxs("select",{value:k,onChange:t=>C(t.target.value),required:!0,className:"w-full px-4 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 touch-manipulation min-h-[44px]",children:[e.jsx("option",{value:"",children:"Select an outcome"}),h.map(t=>e.jsx("option",{value:t.outcome_id,children:p?.market_id==="market-h2h-matchups"?xe(t.name,!0):p?.market_id==="market-individual-net-champion"&&E[t.name]!=null?`${t.name} (${E[t.name]})`:t.name??t.ticker},t.outcome_id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Side"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>Z("ask"),className:`flex-1 min-w-0 py-3 px-4 rounded font-medium text-base min-h-[44px] touch-manipulation ${i==="ask"?"bg-purple-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}`,children:["No/Sell ",O?`$${Math.round(O.price/100)}`:""]}),e.jsxs("button",{type:"button",onClick:()=>Z("bid"),className:`flex-1 min-w-0 py-3 px-4 rounded font-medium text-base min-h-[44px] touch-manipulation ${i==="bid"?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}`,children:["Yes/Buy ",S?`$${Math.round(S.price/100)}`:""]}),g?.view_market_maker&&e.jsx("button",{type:"button",onClick:()=>Z("market_maker"),className:`flex-1 min-w-0 py-3 px-4 rounded font-medium text-base min-h-[44px] touch-manipulation ${i==="market_maker"?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}`,children:"Market Maker"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Quantity"}),e.jsx("input",{ref:fe,type:"tel",inputMode:"numeric",pattern:"[0-9]*",min:"1",value:T,onChange:t=>te(t.target.value),required:!0,className:"w-full px-4 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 min-h-[44px]",placeholder:"Enter quantity"})]}),i==="market_maker"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bid price ($)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-600 dark:text-gray-400",children:"$"}),e.jsx("input",{type:"tel",inputMode:"numeric",pattern:"[0-9]*",min:1,max:99,value:le,onChange:t=>{const r=t.target.value;(r===""||parseInt(r,10)>=1&&parseInt(r,10)<=99)&&re(r)},placeholder:"1-99",className:"w-full pl-8 pr-4 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 min-h-[44px]"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Ask price ($)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-600 dark:text-gray-400",children:"$"}),e.jsx("input",{type:"tel",inputMode:"numeric",pattern:"[0-9]*",min:1,max:99,value:de,onChange:t=>{const r=t.target.value;(r===""||parseInt(r,10)>=1&&parseInt(r,10)<=99)&&se(r)},placeholder:"1-99",className:"w-full pl-8 pr-4 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 min-h-[44px]"})]})]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Price ($)"}),w&&(O||S)&&e.jsx("div",{className:"mb-2 text-xs text-gray-600 dark:text-gray-400",children:e.jsxs("span",{children:["Bid: ",O?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:R(O.price)})," × ",O.contract_size??"—"]}):"—"," | ","Ask: ",S?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-medium text-purple-600 dark:text-purple-400",children:R(S.price)})," × ",S.contract_size??"—"]}):"—"]})}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-600 dark:text-gray-400",children:"$"}),e.jsx("input",{type:"tel",inputMode:"numeric",pattern:"[0-9]*",step:"1",min:"1",max:"99",value:D,onChange:t=>{const r=t.target.value;(r===""||parseInt(r,10)>=1&&parseInt(r,10)<=99)&&(b(r),Y(null))},required:!0,className:`w-full pl-8 pr-4 py-3 text-base border rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 min-h-[44px] ${ge==="price"?"border-primary-500 ring-2 ring-primary-500":"border-gray-300 dark:border-gray-600"}`,placeholder:"1-99"})]})]}),k&&w&&e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:()=>be(t=>!t),className:"text-sm font-medium text-primary-600 dark:text-primary-400 hover:underline flex items-center gap-1",children:[X?"Hide orderbook":"View orderbook",e.jsx("svg",{className:`w-4 h-4 transition-transform ${X?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),X&&e.jsx("div",{className:"mt-2 p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-800/50 max-h-[200px] overflow-y-auto",children:e.jsx(Ne,{bids:w.bids,asks:w.asks,userId:g?.id,onPriceClick:(t,r)=>{const a=Math.round(t/100),s=Math.max(1,Math.min(99,a));b(s.toString()),z(r)},onCancelOrder:async t=>{try{await I.cancelOrder(t),d("Order canceled successfully","success"),await B()}catch(r){d(r?.message||"Failed to cancel order","error")}}})})]}),i==="market_maker"?$.qty>0&&$.mmBidPrice>0&&$.mmAskPrice>0&&e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Bid: $",$.mmBidPrice," × ",$.qty,", Ask: $",$.mmAskPrice," × ",$.qty]})}):D&&T&&e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Estimated Total:"}),e.jsx("span",{className:"text-lg font-semibold",children:H($.totalCost*100)})]})}),e.jsx("button",{type:"submit",disabled:ce,className:`w-full text-white font-medium py-3 px-4 rounded-md disabled:opacity-50 min-h-[44px] text-base touch-manipulation ${i==="ask"?"bg-purple-600 hover:bg-purple-700 active:bg-purple-800":i==="market_maker"?"bg-primary-600 hover:bg-primary-700 active:bg-primary-800":"bg-blue-600 hover:bg-blue-700 active:bg-blue-800"}`,children:ce?"Placing...":i==="market_maker"?"Place both":i==="ask"?"Place Sell Order":"Place Buy Order"})]})}),e.jsx(ve,{isOpen:ye!=null,onClose:()=>Pe(null),onConfirm:()=>{ye!=null&&tt(ye)},title:"Cancel order",message:"Are you sure you want to cancel this order?",confirmLabel:"Cancel order",cancelLabel:"Keep",variant:"danger"}),e.jsx(ve,{isOpen:Ke,onClose:()=>Oe(!1),onConfirm:rt,title:"Cancel all orders",message:"Are you sure you want to cancel all open orders in this market?",confirmLabel:"Cancel all",cancelLabel:"Keep",variant:"danger"}),e.jsx(ve,{isOpen:Ge,onClose:()=>ke(!1),onConfirm:st,title:"Cancel all orders for this outcome",message:`Cancel all ${ie.length} open order(s) for this outcome?`,confirmLabel:"Cancel all",cancelLabel:"Keep",variant:"danger"}),e.jsx("div",{className:"md:hidden h-24"})]})})}export{_t as MarketDetail};

import{r as c,j as e,L as N,b as w}from"./index-BfuHjggV.js";import{f as v}from"./format-Cpou_ref.js";import{f as u}from"./index-BAgxTVAR.js";const _=20,p=["#2563eb","#16a34a","#dc2626","#d97706","#7c3aed","#0d9488","#db2777","#4f46e5","#059669","#ea580c","#0891b2","#c026d3","#e11d48","#0284c7","#65a30d","#9333ea","#0e7490","#c2410c","#0f766e","#be185d","#ca8a04","#1d4ed8","#15803d","#b91c1c"];function M(a){let t=0;for(let s=0;s<a.length;s++)t=(t<<5)-t+a.charCodeAt(s)|0;return Math.abs(t)}function y(a){if(!(!a||a==="—"))return p[M(a)%p.length]}function T(a){const t=Math.floor(Date.now()/1e3-a);if(t<10)return"Just now";if(t<60)return`${t}s ago`;const s=Math.floor(t/60);if(s<60)return`${s}m ago`;const o=Math.floor(s/60);return o<24?`${o}h ago`:u(new Date(a*1e3),"M/d h:mm a")}function L({showTitle:a=!0}){const[t,s]=c.useState([]),[o,i]=c.useState(!0);if(c.useEffect(()=>{async function r(){i(!0);try{const{trades:n}=await w.getTape(_);s(n??[])}catch(n){console.error("Failed to load trade tape:",n),s([])}finally{i(!1)}}r()},[]),o)return e.jsxs("div",{className:"rounded-lg border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800/80 shadow-sm p-4",children:[a&&e.jsx("h2",{className:"text-sm font-bold text-gray-600 dark:text-gray-400 mb-3",children:"Trade tape"}),e.jsx("div",{className:"animate-pulse space-y-2",children:[1,2,3,4,5,6,7].map(r=>e.jsx("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded border border-gray-100 dark:border-gray-700"},r))})]});if(t.length===0)return e.jsxs("div",{className:"rounded-lg border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800/80 shadow-sm p-6",children:[a&&e.jsx("h2",{className:"text-sm font-bold text-gray-600 dark:text-gray-400 mb-3",children:"Trade tape"}),e.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center",children:[e.jsx("svg",{className:"w-10 h-10 text-gray-300 dark:text-gray-600 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":!0,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No recent trades"}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:"Trades will appear here as they happen"})]})]});const f=!a;return e.jsxs("div",{className:"rounded-lg border border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800/80 shadow-sm overflow-hidden",children:[a&&e.jsx("h2",{className:"text-sm font-bold text-gray-600 dark:text-gray-400 px-4 pt-3 pb-2",children:"Trade tape"}),e.jsx("div",{className:`px-3 sm:px-4 ${f?"py-3":"py-2 max-h-[280px] overflow-y-auto"}`,children:e.jsx("div",{className:"space-y-1",children:t.map(r=>{const n=r.buyer_username??"—",d=r.seller_username??"—",l=y(n),x=y(d),b=r.contracts,m=r.outcome_name||r.outcome_ticker||r.outcome||"—",g=r.market_short_name||r.market_id||"—",h=r.market_id??"",k=r.create_time?T(r.create_time):"—",j=(r.taker_side??r.side??0)===0;return e.jsxs(N,{to:h?`/markets/${h}`:"#",className:"flex items-center gap-2 sm:gap-3 py-2.5 px-3 rounded border border-transparent hover:border-gray-200 dark:hover:border-gray-600 hover:bg-gray-50/80 dark:hover:bg-gray-700/30 transition-colors touch-manipulation group",children:[e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap flex-shrink-0 w-14 sm:w-16 text-right",title:r.create_time?u(new Date(r.create_time*1e3),"MMM d, h:mm a"):void 0,children:k}),e.jsx("span",{className:"flex-shrink-0 px-1.5 py-0.5 rounded text-[10px] sm:text-xs font-semibold uppercase tracking-wide min-w-[2rem] text-center {isBuy ? 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300' : 'bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300'}",children:j?"Buy":"Sell"}),e.jsx("span",{className:"truncate min-w-0 text-xs text-gray-500 dark:text-gray-400 flex-shrink-0 max-w-[80px] sm:max-w-[100px]",title:g,children:g}),e.jsx("span",{className:"truncate min-w-0 font-semibold text-sm text-gray-900 dark:text-gray-100 flex-1",title:m,children:m}),e.jsxs("span",{className:"text-sm font-bold text-gray-900 dark:text-gray-100 whitespace-nowrap flex-shrink-0",children:[b," @ ",v(r.price)]}),e.jsxs("span",{className:"hidden sm:inline-flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:[e.jsx("span",{className:"truncate max-w-[60px]",style:l?{color:l}:void 0,title:n,children:n}),e.jsx("span",{"aria-hidden":!0,children:"→"}),e.jsx("span",{className:"truncate max-w-[60px]",style:x?{color:x}:void 0,title:d,children:d})]})]},r.id)})})})]})}function E(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Trade tape"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Recent activity across all markets"})]}),e.jsx(L,{showTitle:!1})]})}export{E as TapePage};

import{r as i,b as R,j as e,L as E,S as u,c as B}from"./index-ClKfCAdh.js";import{M as T,g as z}from"./marketTypes-2i-psQO1.js";import{P as O}from"./PullToRefresh-DhqeLQhP.js";import{E as F}from"./EmptyState-zZAAoKAW.js";function H(r){return r.includes("team-champion")||r.includes("champion")&&!r.includes("individual")?e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}):r.includes("individual")&&(r.includes("net")||r.includes("gross"))?e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}):r.includes("round")||r.includes("ou")?e.jsxs("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v8M8 8h8"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M8 16h8"})]}):r.includes("birdies")||r.includes("birdie")?e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}):r.includes("h2h")||r.includes("matchup")?e.jsxs("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"6",cy:"12",r:"4",strokeWidth:2}),e.jsx("circle",{cx:"18",cy:"12",r:"4",strokeWidth:2}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v6M10.5 12h3"})]}):r.includes("hole-in-one")||r.includes("hio")?e.jsxs("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",strokeWidth:2}),e.jsx("circle",{cx:"12",cy:"12",r:"3",strokeWidth:2})]}):r.includes("eagles")?e.jsxs("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"9",r:"2.5",strokeWidth:2}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 11.5v4c0 1.5-.8 2.8-2 3.5-1.2-.7-2-2-2-3.5v-4"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 11c0 0 2-3 4-3s4 3 4 3"})]}):e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}const w="markets_prefer_fresh_at",P=900*1e3;function A(){try{const r=sessionStorage.getItem(w);if(!r)return!1;const o=parseInt(r,10);return Number.isNaN(o)?!1:Date.now()-o<P}catch{return!1}}function K(){try{sessionStorage.setItem(w,String(Date.now()))}catch{}}function V({tripId:r}){const[o,N]=i.useState([]),[L,x]=i.useState(!0),[p,g]=i.useState(!1),[k,m]=i.useState(null),[M,f]=i.useState(0);i.useEffect(()=>{l(!1,A())},[r]);async function l(s=!1,t=!1){const a=t&&o.length>0;!s&&!a&&(x(!0),m(null)),a&&g(!0);try{const{markets:n}=await R.getMarkets(t?{cacheBust:!0}:void 0);N(n??[]),m(null),f(0)}catch(n){console.error("Failed to load markets:",n);const h=n?.message||"Failed to load markets";m(h),!s&&M===0&&setTimeout(()=>{f(1),l(!0,!1)},2e3)}finally{x(!1),g(!1)}}async function j(){await l(!1,!0),K()}const c=o.reduce((s,t)=>{let a=t.market_type||"other";return a==="other"&&(t.market_id==="market-total-birdies"||t.market_id==="market_total_birdies")&&(a="market_total_birdies"),a==="other"&&(t.market_id==="market-total-pars"||t.market_id==="market_total_pars")&&(a="market_total_pars"),s[a]||(s[a]=[]),s[a].push(t),s},{}),v=[...T],y=["market-h2h-matchups","market-round-matchups","market-special-matchups"],_=v.filter(s=>c[s]?.length>0),S=Object.keys(c).filter(s=>!v.includes(s)&&c[s]?.length>0),C=[..._,...S];function W(s,t){return s!=="matchups"||t.length<=1?t:[...t].sort((a,n)=>{const h=y.indexOf(a.market_id),b=y.indexOf(n.market_id);return(h===-1?999:h)-(b===-1?999:b)})}let d;return L&&o.length===0?d=e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{variant:"text",width:"40%",height:28,className:"mb-4"}),e.jsx("div",{className:"grid gap-2 sm:gap-3",children:[1,2,3,4,5,6].map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-3 sm:p-4 border border-gray-200 dark:border-gray-600 rounded-lg",children:[e.jsx(u,{variant:"circular",width:32,height:32}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(u,{variant:"text",width:s%2===0?"70%":"85%",height:18}),e.jsx(u,{variant:"text",width:"50%",height:14})]})]},s))})]}):k&&o.length===0?d=e.jsxs("div",{className:"text-center py-8",children:[e.jsxs("div",{className:"text-red-600 dark:text-red-400 mb-4",children:[e.jsx("p",{className:"font-semibold",children:"Error loading markets"}),e.jsx("p",{className:"text-sm mt-2",children:k})]}),e.jsx("button",{onClick:()=>l(),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Retry"})]}):d=e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[C.map(s=>{const t=W(s,c[s]),a=z(s);return e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsx("h2",{className:"text-base sm:text-lg font-bold text-gray-900 dark:text-gray-100 border-b border-gray-300 dark:border-gray-600 pb-1.5",children:a}),e.jsx("div",{className:"grid gap-2 sm:gap-3",children:t.map(n=>e.jsxs(E,{to:`/markets/${n.market_id}`,className:"flex items-center gap-2 sm:gap-3 p-3 sm:p-4 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 hover:border-primary-500 dark:hover:border-primary-400 hover:shadow-md transition-all cursor-pointer touch-manipulation active:bg-gray-100 dark:active:bg-gray-700 active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900",children:[e.jsx("div",{className:"flex-shrink-0 text-primary-600 dark:text-primary-400",children:e.jsx("div",{className:"w-8 h-8 sm:w-7 sm:h-7",children:H(n.market_id)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-sm sm:text-base text-gray-900 dark:text-gray-100 truncate",children:n.short_name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[(n.volume_contracts??0).toLocaleString()," shares"," Â· ","$",((n.volume_contracts??0)*100).toLocaleString()," volume"]})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]},n.id))})]},s)}),o.length===0&&e.jsx(F,{icon:e.jsx("svg",{className:"w-16 h-16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),title:"No markets found",message:"There are no markets available right now. Check back later or refresh the page."})]}),e.jsxs(O,{onRefresh:j,children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4 sm:mb-6",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Markets"}),e.jsx("button",{type:"button",onClick:j,disabled:p,className:"p-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 transition-colors touch-manipulation",title:"Bypass cache and reload markets","aria-label":"Refresh markets",children:e.jsx("svg",{className:`w-5 h-5 ${p?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":!0,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),d]})}function Q(){const r=B();return e.jsx("div",{className:"space-y-4 sm:space-y-6",children:e.jsx(V,{},r.key)})}export{Q as MarketsPage};
